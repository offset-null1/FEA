<!--
=========================================================
* BLK Design System- v1.0.0
=========================================================

* Product Page: https://www.creative-tim.com/product/blk-design-system
* Copyright 2019 Creative Tim (https://www.creative-tim.com)
* Licensed under MIT

* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 -->
 <!DOCTYPE html>
 <html lang="en">
 
 <head>
   <meta charset="utf-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
   <link rel="apple-touch-icon" sizes="76x76" href="{{ url_for('static',filename='assets/img/apple-icon.png')}}">
   <link rel="icon" type="image/png" href="{{ url_for('static',filename='assets/img/favicon.png')}}">
   <title>
     FEA• Face Enabled Attendance System
   </title>
   
   <!--     Fonts and icons     -->
   <link href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,600,700,800" rel="stylesheet" />
   <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
   <!-- Nucleo Icons -->
   <link rel="stylesheet" href="{{ url_for('static',filename='assets/css/nucleo-icons.css')}}" />
   <!-- CSS Files -->
   <link rel="stylesheet" href="{{ url_for('static',filename='assets/css/blk-design-system.css')}}"/>
   <!-- CSS Just for demo purpose, don't include it in your project -->
   <link rel="stylesheet" href="{{ url_for('static',filename='assets/demo/demo.css')}}"  />
 </head>
 
 <body class="landing-page">
   <!-- Navbar -->
   <nav class="navbar navbar-expand-lg fixed-top navbar-transparent " color-on-scroll="100">
    <div class="container">
      <div class="navbar-translate">
        <a class="navbar-brand" href="{{ url_for('base') }}" rel="tooltip" title="FEA• By Dakshta" data-placement="bottom" target="_blank">
          <span>FEA•</span> Face Enabled Attendance System
        </a>
        <button class="navbar-toggler navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-bar bar1"></span>
          <span class="navbar-toggler-bar bar2"></span>
          <span class="navbar-toggler-bar bar3"></span>
        </button>
      </div>
      <div class="collapse navbar-collapse justify-content-end" id="navigation">
        <div class="navbar-collapse-header">
          <div class="row">
            <div class="col-6 collapse-brand">
              <a>
                FEA•
              </a>
            </div>
            <div class="col-6 collapse-close text-right">
              <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navigation" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
                <i class="tim-icons icon-simple-remove"></i>
              </button>
            </div>
          </div>
        </div>
        <ul class="navbar-nav">
          <li class="nav-item p-0">
            <a class="nav-link" rel="tooltip" title="Start taking attendance" data-placement="bottom" href="{{ url_for('attendance') }}"target="_blank">
              <i class="tim-icons icon-badge"></i>
              <p class="d-lg-none d-xl-none">Attendance</p>
            </a>
          </li>
          <li class="nav-item p-0">
            <a class="nav-link" rel="tooltip" title="Register a student" data-placement="bottom" href="{{ url_for('form') }}" target="_blank">
              <i class="tim-icons icon-paper"></i>
              <p class="d-lg-none d-xl-none">Register</p>
            </a>
          </li>
          <li class="nav-item p-0">
            <a class="nav-link" rel="tooltip" title="Upload student marks" data-placement="bottom" href="{{ url_for('upload') }}" target="_blank">
              <i class="tim-icons icon-upload"></i>
              <p class="d-lg-none d-xl-none">Upload</p>
            </a>
          </li>
          <li class="dropdown nav-item">
            <a href="#" class="dropdown-toggle nav-link" data-toggle="dropdown">
              <i class="tim-icons icon-chart-bar-32"></i> Analyze
            </a>
            <div class="dropdown-menu dropdown-with-icons">
              <a href="#" class="dropdown-item">
                <i class="tim-icons icon-paper"></i> Marks
              </a>
              <a href="#" class="dropdown-item">
                <i class="tim-icons icon-notes"></i>Attendance
              </a>
              <a href="#" class="dropdown-item">
                <i class="tim-icons icon-bulb-63"></i>Project
              </a>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </nav>

   <!-- End Navbar -->
   <div class="wrapper">
     <div class="page-header">
       <img src="{{ url_for('static', filename='assets/img/blob.png')}}" class="path">
       <img src="{{ url_for('static', filename='assets/img/path2.png')}}" class="path2">
       <img src="{{ url_for('static', filename='assets/img/triunghiuri.png')}}" class="shapes triangle">
       <img src="{{ url_for('static', filename='assets/img/waves.png')}}" class="shapes wave">
       <img src="{{ url_for('static', filename='assets/img/patrat.png')}}" class="shapes squares">
       <img src="{{ url_for('static', filename='assets/img/cercuri.png')}}" class="shapes circle">
       <div class="content-center">
         <div class="row row-grid justify-content-center align-items-center text-center">
          <div class="row">    
            <div class="col-lg-6" >  
                <div class="text-center">
                    <h1>
                        Live Training  
                    </h1> 

                    <h4>    
                        Webcam feed  
                    </h4>  
                
                
                    <button class="btn btn-primary" id="btnCapture" style="text-align:center" onclick="capture();">Click to capture</button>    
                
                    <video id="video" playsinline autoplay></video>    
                
        
                    <div class="col-lg-6" class="text-center">    
                        <h4>    
                            Captured image from Webcam    
                        </h4>   

                        <canvas style="border:solid 1px  rgb(121, 5, 121); background-color:rgb(19, 1, 1);" id="canvas" width="600" height="500"></canvas>    
                    </div>    
        
        
                    <button type="button" class="btn btn-danger btn-lg" style="text-align:center" onclick="redirect();">Cancel</button>
        
        
                </div> 
        
           </div>
      </div>
    </div>
  </div>

  
 


 <form action="{{ url_for('form') }}" method="post" onsubmit="post();" > 
    <!-- onsubmit="send();"  -->

  <div class="jumbotron">    
    <p><span id="errorMsg"></span></p>  
  


  
    <fieldset>
      <legend>REGISTRATION </legend>
      <input id="img" name="img" type="hidden" value="">
    </div>
    <div class="form-group">
      <label for="usn">Enter your USN </label>
      <input type="text" name="usn" class="form-control" id="usn"  placeholder="USN" required>
      
    </div>

      <div class="form-group">
        <label for="fname">Enter your first name </label>
        <input type="text" name="fname" class="form-control" id="fname"  placeholder="First name" required>
           
      </div>
      <div class="form-group">
        <label for="lname">Enter your last name </label>
        <input type="text" name="lname" class="form-control" id="lname"  placeholder="Last name" required>
        
      </div>
      <div class="form-group">
        <label for="email">Email address</label>
        <input type="email" name="email" class="form-control" id="email"  placeholder="Enter email" required autofocus>
        <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
      </div>

    </div>
    <div class="form-group">
      <label for="phone_no">Phone Number </label>
      <input type="phone_no" name="phone_no" class="form-control" id="phone_no"  placeholder="Phone Number" required>
      
    </div>

      <div class="form-group">
        <label for="semester">Select Your Semester</label>
        <select class="form-control" name="semester" id="semester" required>
          <option>1</option>
          <option>2</option>
          <option>3</option>
          <option>4</option>
          <option>5</option>
          <option>6</option>
          <option>7</option>
        </select>
      </div>

      <div class="form-group">
        <label for="branch">Select Your Semester</label>
        <select class="form-control" name="branch" id="branch" required>
          <option>CSE ComputerScience</option>
          <option>ECE Electronics&Communication</option>
          <option>CE Civil</option>
          <option>ME Mechanical</option>
          <option>TE Textile</option>
        </select>
      </div>
    </fieldset>
    <button type="submit" id='submit' class="btn btn-primary" >Submit</button>
    </fieldset>
    <p>
    <small id="Help" class="form-text text-muted" >Submit the form to proceed for the training process.</small>
    </p>
    
</form> 
 </body>

 <script src="{{ url_for('static',filename='assets/js/core/jquery.min.js')}}" type="text/javascript"></script>
 <script src="{{ url_for('static',filename='assets/js/core/popper.min.js')}}" type="text/javascript"></script>
 <script src="{{ url_for('static',filename='assets/js/core/bootstrap.min.js')}}" type="text/javascript"></script>
 <script src="{{ url_for('static',filename='assets/js/plugins/perfect-scrollbar.jquery.min.js')}}"></script>
 <!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
 <script src="{{ url_for('static',filename='assets/js/plugins/bootstrap-switch.js')}}"></script>
 <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
 <script src="{{ url_for('static',filename='assets/js/plugins/nouislider.min.js')}}" type="text/javascript"></script>

 <script src="{{ url_for('static', filename='assets/js/blk-design-system.min.js')}}" type="text/javascript"></script>

<script>
      
      if (navigator.mediaDevices.getUserMedia) {
            navigator.mediaDevices.getUserMedia({ video: true,
                audio: false,  
                video: {  
                    width: 600, height: 500  
          }   })
            .then(function (stream) {                                                    
                video.srcObject = stream;
                video.play();
             
            })
            .catch(function (error) {
                console.log(error)
                console.log("Something went wrong!");
            })
        }
      
      
        
      var video = document.querySelector("#video"); 
      var canvas = document.getElementById('canvas');
      var context = canvas.getContext('2d');
      imgArray = []

        function capture(){
            var i=0;
            var interval = setInterval(function(){
                context.drawImage(video, 0, 0);  
        
                var url =  canvas.toDataURL('image/png');
                var data_url=url.replace('data:image/png;base64,','');
                imgArray.push(data_url);
                console.log(imgArray[i]);
                i+=1;
                console.log(i);
                if(i==50){
                    clearInterval(interval);
                }
            },100);
        };    
    
           
    function post(){
        document.getElementById('img').value = JSON.stringify(imgArray);
      }
      

    function redirect(){
        window.location.replace("http://localhost:5000/");
    }

</script>

</html>